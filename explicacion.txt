-------------------------------------------------------------------
Fase 1: Detectando el "Pulso" del Mercado (Hidden Markov Models)
----------------------------------------------------------------------

Para calcular el HMM se tiene en cuanta los siguientes datos:
** Retornos diarios de SP&500
** Ratio de Amihud: como feature de liquidez
** VIXCLS: Mide la volatilidad implícita esperada para los próximos 30 días, con opciones del S&P500
** DSG10: Capturan shocks en expectativas de largo plazo, com oInflación futura, crecimiento esperado y politica monetaria futura. 
** DSG2: Capturan shocks en el corto plazo, ligados a decisiones inmediatas de la FED y expectativas de subidas/bajadas de tipos oficicales.
   Cambios en la pendiente (DGS10 – DGS2), Capturan shocks de la forma de la curva, como:
        Curva que se aplana → preocupación económica
        Curva que se empina → expectativas de recuperación económica
        Inversiones bruscas → señales de riesgo o recesión
** BAMLH0A0HYM2: nivel y cambio del spread de high yield (proxy de tensión crediticia).
** CFNAIMA3: proxy de PMI, no esta disponible desde 2003. Indice de 85 indicadores económocos de EEUU. Su objetivo es medir si la economía está por encima de la tendencia histórica o por debajo. 
** CPI es una medida mensual, indica los indice de precios de consumo, la pérdida o ganancia de poder adquisitivo de los hogares   
** unrate: mide la tasa de desempleo. 

Me gustaría calcular alún parametro de sentimiento, como Put/Call Raiio o como AAII, PERO NO SOY CAPAZ DE ENCONTRAR DATOS.

He calculado pintado la gráfica usando el modelo Gaussian HMM, me queda parecida a la que enseño en clase, pero hay franjas muy estrechas, quizas haya que poner alguna condicion extra.

-----------------------------------------------------------------------------
Fase 2: Anatomía del Riesgo (Análisis Marginal)
--------------------------------------------------------------------------
Para cada activo y para cada régimen calculado en HMM hay que calculas:
        medida
        volatilidad
        skewness
        kurtosis

Con esto te permite ver como cambia el comportamiento de cada activo en crisis, si se vuelven más volatil, si desarrolla colas pesadas, si cambia su asimetria, si actua como refugio o se hunde.   

Lo primero que hago es crear un df con los retornos diarios de la cartera. He calculado las metricas por cada activo y periodo de calma y crisis (NO estoy segura de si es lo que pide)